<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Quick Temp</title>
<link rel="manifest" href="manifest.json">
<style>
    body {
        background-color: #121212;
        color: white;
        font-family: Arial, sans-serif;
        text-align: center;
        margin: 0;
        padding: 0;
    }
    h1 {
        font-size: 1.5rem;
        margin-top: 10px;
    }
    #temperature {
        font-size: 3rem;
        margin: 10px 0;
    }
    #humidityAqi {
        font-size: 1.2rem;
        color: #ccc;
        margin-bottom: 10px;
    }
    .info {
        font-size: 1rem;
        margin: 5px 0;
    }
    button {
        background-color: #333;
        color: white;
        border: none;
        padding: 12px 20px;
        margin: 5px;
        cursor: pointer;
        font-size: 1.5rem;
        border-radius: 6px;
    }
    button:hover {
        background-color: #555;
    }
    .small-btn {
        padding: 10px 16px;
        font-size: 1.2rem;
    }
    .update-container {
        display: flex;
        justify-content: center;
        align-items: center;
        gap: 8px;
        margin: 10px 0;
    }
    .interval-controls {
        margin-top: 5px;
    }
</style>
</head>
<body>

<img src="icons/icon-192x192.png" alt="Thermometer" width="80" style="margin-top:15px;">
<h1 id="location">Loading...</h1>
<div id="temperature">-- °C</div>
<div id="humidityAqi">Humidity: --% | AQI: -- (--)</div>
<div class="info" id="coords"></div>
<div class="info" id="condition"></div>

<div class="update-container">
    <div id="updatedTime">Updated: --:--:--</div>
    <button id="refreshBtn">⟳</button>
</div>

<div class="interval-controls">
    <button id="decreaseInterval" class="small-btn">▼</button>
    <span id="intervalDisplay">60s</span>
    <button id="increaseInterval" class="small-btn">▲</button>
</div>

<div style="margin-top:15px; font-size:0.9rem;">APP-BY-JEET</div>

<script>
const API_KEY = "679bddf7884949109fa193814251408"; // your key
let refreshInterval = 60; // seconds
let autoRefreshTimer;

function getAqiCategory(aqi) {
    if (aqi <= 50) return "Good";
    if (aqi <= 100) return "Moderate";
    if (aqi <= 150) return "Unhealthy for Sensitive Groups";
    if (aqi <= 200) return "Unhealthy";
    if (aqi <= 300) return "Very Unhealthy";
    return "Hazardous";
}

function fetchWeather() {
    navigator.geolocation.getCurrentPosition(pos => {
        const lat = pos.coords.latitude;
        const lon = pos.coords.longitude;

        fetch(`https://api.weatherapi.com/v1/current.json?key=${API_KEY}&q=${lat},${lon}&aqi=yes`)
            .then(res => res.json())
            .then(data => {
                document.getElementById('location').innerText = data.location.name + ", " + data.location.region;
                document.getElementById('temperature').innerText = data.current.temp_c + " °C";
                document.getElementById('coords').innerText = `Latitude: ${lat}, Longitude: ${lon}`;
                document.getElementById('condition').innerText = data.current.condition.text;

                // Humidity and AQI in one line
                let humidity = data.current.humidity;
                let aqiValue = data.current.air_quality["pm2_5"];
                let aqiCategory = getAqiCategory(aqiValue);
                document.getElementById('humidityAqi').innerText = `Humidity: ${humidity}% | AQI: ${aqiValue.toFixed(1)} (${aqiCategory})`;

                // Update time
                const now = new Date();
                document.getElementById('updatedTime').innerText = "Updated: " + now.toLocaleTimeString();
            })
            .catch(err => console.error(err));
    });
}

function startAutoRefresh() {
    clearInterval(autoRefreshTimer);
    autoRefreshTimer = setInterval(fetchWeather, refreshInterval * 1000);
}

document.getElementById('refreshBtn').addEventListener('click', fetchWeather);
document.getElementById('increaseInterval').addEventListener('click', () => {
    refreshInterval += 10;
    document.getElementById('intervalDisplay').innerText = refreshInterval + "s";
    startAutoRefresh();
});
document.getElementById('decreaseInterval').addEventListener('click', () => {
    if (refreshInterval > 10) {
        refreshInterval -= 10;
        document.getElementById('intervalDisplay').innerText = refreshInterval + "s";
        startAutoRefresh();
    }
});

fetchWeather();
startAutoRefresh();
</script>
</body>
</html>
